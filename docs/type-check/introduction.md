# Type checking

Type checking enables validation of deployed bytecode against local artifacts, ensuring accuracy. This facilitates
developer A's contract deployment, with developer B verifying A's deployments via the type checking script.
Moreover, A benefits from self-verification, streamlining the process. A can initiate verification by locally deploying
the contract through Foundry, then comparing the generated bytecode with the on-chain version.
This method ensures consistency and integrity across deployments, fostering trust and reliability within the development ecosystem.
By leveraging type checking, developers can efficiently validate contracts, enhancing transparency and security in blockchain development workflows.

## Setting up

## Step 1: Add Dependency

Add `forge-proposal-simulator` to your project using Forge:

```sh
forge install https://github.com/solidity-labs-io/forge-proposal-simulator.git
```

## Step 2: Remapping

Update your remappings.txt to include:

```txt
@forge-proposal-simulator=lib/forge-proposal-simulator/
```

## Step 3: Addresses File

Create a JSON file following the standard on
[Addresses](../overview/architecture/addresses.md). We recommend to keep the
addresses file in a separate folder, for example `./addresses/addresses.json`.
Add the deployed contracts to `Addresses.json`.

## Step 4: TypeCheckAddresses File

Create a `TypeCheckAddresses.json` file following the instructions provided in [type-check.md](./type-check.md).

## Step 5: Install npm packages

Enter `lib/forge-proposal-simulator/typescript` directory and install npm packages.

```bash
cd lib/forge-proposal-simulator/typescript && npm i
```

Change directory again to the root repo

```bash
cd ../../../
```

## Step 6: Add environment variables

Add below environment variables to `.env`.

```
ADDRESSES_PATH                # Path to addresses.json file
TYPE_CHECK_ADDRESSES_PATH     # Path to typeCheckAddresses.json file
ARTIFACT_PATH                 # Path of artifact folder
```

Example:

```
TYPE_CHECK_ADDRESSES_PATH=addresses/TypeCheckAddresses.json
ADDRESSES_PATH=addresses/Addresses.json
ARTIFACT_PATH=out/
```

## Step 7: File read accesss

Make sure to allow read access to `Addresses.json`, `TypeCheckAddresses.json` and `artifact` folder inside of `foundry.toml`.

```toml
[profile.default]

fs_permissions = [{ access = "read", path = "./"}]
```
