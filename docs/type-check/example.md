# Example Type check

After adding FPS into project dependencies and setting up through [Setup guide](./introduction.md#setting-up), its time to go through an example contract to understand how type checking works.

## Example Contracts

The [folder](../../src/type-check) includes contracts used in the guide mentioned
below for demonstration purposes. Examples include [ExampleTypeCheck.sol](../../src/type-check/ExampleTypeCheck.sol)
and [ExampleTypeCheck_02.sol](../../src/type-check/ExampleTypeCheck_02.sol).

Add file `ExampleTypeCheck.sol` in `src` of root repository:

```solidity
// SPDX-License-Identifier: GPL-3.0

pragma solidity =0.8.19;

contract ExampleTypeCheck {
    struct StructC {
        string varC1;
        uint256 varC2;
    }

    struct StructB {
        bytes varB1;
        uint256 varB2;
        StructC structC;
    }
    struct StructA {
        address varA1;
        bytes32 varA2;
        StructB structB;
    }

    constructor(
        StructA memory structA,
        string[] memory arg1,
        uint256[] memory arg2,
        StructB[] memory structb
    ) {}

    function encode(
        StructA memory structA,
        string[] memory arg1,
        uint256[] memory arg2,
        StructB[] memory structb
    ) external pure returns (bytes memory) {
        return abi.encode(structA, arg1, arg2, structb);
    }
}
```

The contract constructor arguments looks complex for this example, luckily, we already have the constructor arguments ready for you.

In the file `TypeCheckAddresses.json` that you have already made in setup, add another object in json file for the above contract:

```json
{
    "name": "ExampleTypeCheck",
    "constructorArgs": "[[\"0x95222290DD7278Aa3Ddd389Cc1E1d165CC4BAfe5\", \"0x95222290dd7278aa3ddd389cc1e1d165cc4bafe5000000000000000000000000\", [\"0x95222290DD7278Aa3Ddd389Cc1E1d165CC4BAfe5\", 2, [\"0x95222290DD7278Aa3Ddd389Cc1E1d165CC4BAfe5\", 2]]], [\"Arg1\", \"Arg2\"], [2, 3], [[\"0x95222290DD7278Aa3Ddd389Cc1E1d165CC4BAfe5\", 2, [\"0x95222290DD7278Aa3Ddd389Cc1E1d165CC4BAfe5\", 2]], [\"0x95222290DD7278Aa3Ddd389Cc1E1d165CC4BAfe5\", 2, [\"0x95222290DD7278Aa3Ddd389Cc1E1d165CC4BAfe5\", 2]]]]",
    "artifactPath": "ExampleTypeCheck.sol:ExampleTypeCheck"
}
```

Now add the below object in `Addresses.json`:

```json
{
        "addr": "0x293cad26033577eb68137603a34d2dbfd05104d8",
        "chainId": 11155111,
        "name": "ExampleTypeCheck",
        "isContract": true
    },
```

The above contract is already deployed on sepolia testnet and we will ensure the correct contract is deployed by verifying bytecode of sepolia contract with the local bytecode of `ExampleTypeCheck` contract.

Assuming you have already installed npm packages and added environment variables in [Setup guide](./introduction.md#setting-up).

Make sure to allow read access to `Addresses.json`, `TypeCheckAddresses.json` and `artifact` folder inside of `foundry.toml`.

```toml
[profile.default]

fs_permissions = [{ access = "read", path = "./"}]
```

Run the following command on the root repo to type check all contracts added in `TypeCheckAddresses.json`.

```bash
forge script lib/forge-proposal-simulator/script/TypeCheck.s.sol:TypeCheck --ffi --fork-url "https://ethereum-sepolia-rpc.publicnode.com"
```

The script should run successfully that the deployed contract is correct. The command should create the following output, as shown below:

```txt
Script ran successfully.

== Logs ==

Contract: ExampleTypeCheck
  Encoded contructor args :
  0x000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000002200000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000036000000000000000000000000095222290dd7278aa3ddd389cc1e1d165cc4bafe595222290dd7278aa3ddd389cc1e1d165cc4bafe500000000000000000000000000000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000001495222290dd7278aa3ddd389cc1e1d165cc4bafe500000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000002a3078393532323232393044443732373841613344646433383943633145316431363543433442416665350000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000044172673100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000441726732000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000001495222290dd7278aa3ddd389cc1e1d165cc4bafe500000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000002a307839353232323239304444373237384161334464643338394363314531643136354343344241666535000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000060000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000001495222290dd7278aa3ddd389cc1e1d165cc4bafe500000000000000000000000000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000002a30783935323232323930444437323738416133446464333839436331453164313635434334424166653500000000000000000000000000000000000000000000
  Local deployed bytecode:
  0x608060405234801561001057600080fd5b506004361061002b5760003560e01c806325b3caa214610030575b600080fd5b61004361003e3660046103f6565b610059565b6040516100509190610540565b60405180910390f35b606084848484604051602001610072949392919061063d565b6040516020818303038152906040529050949350505050565b634e487b7160e01b600052604160045260246000fd5b6040516060810167ffffffffffffffff811182821017156100c4576100c461008b565b60405290565b6040805190810167ffffffffffffffff811182821017156100c4576100c461008b565b604051601f8201601f1916810167ffffffffffffffff811182821017156101165761011661008b565b604052919050565b600067ffffffffffffffff8311156101385761013861008b565b61014b601f8401601f19166020016100ed565b905082815283838301111561015f57600080fd5b828260208301376000602084830101529392505050565b600082601f83011261018757600080fd5b6101968383356020850161011e565b9392505050565b6000606082840312156101af57600080fd5b6101b76100a1565b9050813567ffffffffffffffff808211156101d157600080fd5b818401915084601f8301126101e557600080fd5b6101f48583356020850161011e565b835260208401356020840152604084013591508082111561021457600080fd5b908301906040828603121561022857600080fd5b6102306100ca565b82358281111561023f57600080fd5b61024b87828601610176565b8252506020830135602082015280604085015250505092915050565b600067ffffffffffffffff8211156102815761028161008b565b5060051b60200190565b600082601f83011261029c57600080fd5b813560206102b16102ac83610267565b6100ed565b82815260059290921b840181019181810190868411156102d057600080fd5b8286015b8481101561031057803567ffffffffffffffff8111156102f45760008081fd5b6103028986838b0101610176565b8452509183019183016102d4565b509695505050505050565b600082601f83011261032c57600080fd5b8135602061033c6102ac83610267565b82815260059290921b8401810191818101908684111561035b57600080fd5b8286015b84811015610310578035835291830191830161035f565b600082601f83011261038757600080fd5b813560206103976102ac83610267565b82815260059290921b840181019181810190868411156103b657600080fd5b8286015b8481101561031057803567ffffffffffffffff8111156103da5760008081fd5b6103e88986838b010161019d565b8452509183019183016103ba565b6000806000806080858703121561040c57600080fd5b843567ffffffffffffffff8082111561042457600080fd5b908601906060828903121561043857600080fd5b6104406100a1565b82356001600160a01b038116811461045757600080fd5b81526020838101359082015260408301358281111561047557600080fd5b6104818a82860161019d565b6040830152509550602087013591508082111561049d57600080fd5b6104a98883890161028b565b945060408701359150808211156104bf57600080fd5b6104cb8883890161031b565b935060608701359150808211156104e157600080fd5b506104ee87828801610376565b91505092959194509250565b6000815180845260005b8181101561052057602081850181015186830182015201610504565b506000602082860101526020601f19601f83011685010191505092915050565b60208152600061019660208301846104fa565b600081516060845261056860608501826104fa565b9050602083015160208501526040830151848203604086015280516040835261059460408401826104fa565b6020928301519390920192909252949350505050565b600081518084526020808501945080840160005b838110156105da578151875295820195908201906001016105be565b509495945050505050565b600082825180855260208086019550808260051b84010181860160005b8481101561063057601f1986840301895261061e838351610553565b98840198925090830190600101610602565b5090979650505050505050565b608080825285516001600160a01b03169082015260208086015160a08301526040860151606060c08401526000919061067960e0850182610553565b9050838103828501528087518083528383019150838160051b840101848a0160005b838110156106c957601f198684030185526106b78383516104fa565b9487019492509086019060010161069b565b505086810360408801526106dd818a6105aa565b94505050505082810360608401526106f581856105e5565b97965050505050505056fe
  Deployed bytecode:
  0x608060405234801561001057600080fd5b506004361061002b5760003560e01c806325b3caa214610030575b600080fd5b61004361003e3660046103f6565b610059565b6040516100509190610540565b60405180910390f35b606084848484604051602001610072949392919061063d565b6040516020818303038152906040529050949350505050565b634e487b7160e01b600052604160045260246000fd5b6040516060810167ffffffffffffffff811182821017156100c4576100c461008b565b60405290565b6040805190810167ffffffffffffffff811182821017156100c4576100c461008b565b604051601f8201601f1916810167ffffffffffffffff811182821017156101165761011661008b565b604052919050565b600067ffffffffffffffff8311156101385761013861008b565b61014b601f8401601f19166020016100ed565b905082815283838301111561015f57600080fd5b828260208301376000602084830101529392505050565b600082601f83011261018757600080fd5b6101968383356020850161011e565b9392505050565b6000606082840312156101af57600080fd5b6101b76100a1565b9050813567ffffffffffffffff808211156101d157600080fd5b818401915084601f8301126101e557600080fd5b6101f48583356020850161011e565b835260208401356020840152604084013591508082111561021457600080fd5b908301906040828603121561022857600080fd5b6102306100ca565b82358281111561023f57600080fd5b61024b87828601610176565b8252506020830135602082015280604085015250505092915050565b600067ffffffffffffffff8211156102815761028161008b565b5060051b60200190565b600082601f83011261029c57600080fd5b813560206102b16102ac83610267565b6100ed565b82815260059290921b840181019181810190868411156102d057600080fd5b8286015b8481101561031057803567ffffffffffffffff8111156102f45760008081fd5b6103028986838b0101610176565b8452509183019183016102d4565b509695505050505050565b600082601f83011261032c57600080fd5b8135602061033c6102ac83610267565b82815260059290921b8401810191818101908684111561035b57600080fd5b8286015b84811015610310578035835291830191830161035f565b600082601f83011261038757600080fd5b813560206103976102ac83610267565b82815260059290921b840181019181810190868411156103b657600080fd5b8286015b8481101561031057803567ffffffffffffffff8111156103da5760008081fd5b6103e88986838b010161019d565b8452509183019183016103ba565b6000806000806080858703121561040c57600080fd5b843567ffffffffffffffff8082111561042457600080fd5b908601906060828903121561043857600080fd5b6104406100a1565b82356001600160a01b038116811461045757600080fd5b81526020838101359082015260408301358281111561047557600080fd5b6104818a82860161019d565b6040830152509550602087013591508082111561049d57600080fd5b6104a98883890161028b565b945060408701359150808211156104bf57600080fd5b6104cb8883890161031b565b935060608701359150808211156104e157600080fd5b506104ee87828801610376565b91505092959194509250565b6000815180845260005b8181101561052057602081850181015186830182015201610504565b506000602082860101526020601f19601f83011685010191505092915050565b60208152600061019660208301846104fa565b600081516060845261056860608501826104fa565b9050602083015160208501526040830151848203604086015280516040835261059460408401826104fa565b6020928301519390920192909252949350505050565b600081518084526020808501945080840160005b838110156105da578151875295820195908201906001016105be565b509495945050505050565b600082825180855260208086019550808260051b84010181860160005b8481101561063057601f1986840301895261061e838351610553565b98840198925090830190600101610602565b5090979650505050505050565b608080825285516001600160a01b03169082015260208086015160a08301526040860151606060c08401526000919061067960e0850182610553565b9050838103828501528087518083528383019150838160051b840101848a0160005b838110156106c957601f198684030185526106b78383516104fa565b9487019492509086019060010161069b565b505086810360408801526106dd818a6105aa565b94505050505082810360608401526106f581856105e5565b97965050505050505056fe
```
